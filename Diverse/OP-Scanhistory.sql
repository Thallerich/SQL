SELECT OPScans.Code, OPScans.Zeitpunkt, ZielNr.ZielNrBez$LAN$ AS ZielNr, WegGrund.WegGrundBez$LAN$ AS Grund, ISNULL(OPScans.User_, OPScans.AnlageUser_) AS [User], ISNULL(AnfKoIn.AuftragsNr, AnfKoOut.AuftragsNr) AS Packzettel, ISNULL(AnfKoIn.Lieferdatum, AnfKoOut.Lieferdatum) AS [PZ-Lieferdatum]
FROM WegGrund, ZielNr, (
  SELECT OPTeile.Code, OPScans.*
  FROM OPScans, OPTeile
  WHERE OPScans.OPTeileID = OPTeile.ID
    AND (
      OPTeile.Code IN ('1022115666', '1017409435', '1010843243', '1010703172', '1010824662', '1011579080', '1010816735', '1011623776', '1023941172', '1010844882', '1022115857', '1022116724', '1017520772', '1011130304', '1016610511', '1011173264', '1023961255', '1011577451', '1011133725', '1011069970', '1022318845')
      OR OPTeile.Code2 IN ('1022115666', '1017409435', '1010843243', '1010703172', '1010824662', '1011579080', '1010816735', '1011623776', '1023941172', '1010844882', '1022115857', '1022116724', '1017520772', '1011130304', '1016610511', '1011173264', '1023961255', '1011577451', '1011133725', '1011069970', '1022318845')
    )
  
  UNION ALL
  
  SELECT OPTeile.Code, OPScans.*
  FROM _OPScans_20160306 OPScans, OPTeile
  WHERE OPScans.OPTeileID = OPTeile.ID
    AND (
      OPTeile.Code IN ('1022115666', '1017409435', '1010843243', '1010703172', '1010824662', '1011579080', '1010816735', '1011623776', '1023941172', '1010844882', '1022115857', '1022116724', '1017520772', '1011130304', '1016610511', '1011173264', '1023961255', '1011577451', '1011133725', '1011069970', '1022318845')
      OR OPTeile.Code2 IN ('1022115666', '1017409435', '1010843243', '1010703172', '1010824662', '1011579080', '1010816735', '1011623776', '1023941172', '1010844882', '1022115857', '1022116724', '1017520772', '1011130304', '1016610511', '1011173264', '1023961255', '1011577451', '1011133725', '1011069970', '1022318845')
    )
    
  UNION ALL
  
  SELECT OPTeile.Code, OPScans.*
  FROM _OPScans_20160307 OPScans, OPTeile
  WHERE OPScans.OPTeileID = OPTeile.ID
    AND (
      OPTeile.Code IN ('1022115666', '1017409435', '1010843243', '1010703172', '1010824662', '1011579080', '1010816735', '1011623776', '1023941172', '1010844882', '1022115857', '1022116724', '1017520772', '1011130304', '1016610511', '1011173264', '1023961255', '1011577451', '1011133725', '1011069970', '1022318845')
      OR OPTeile.Code2 IN ('1022115666', '1017409435', '1010843243', '1010703172', '1010824662', '1011579080', '1010816735', '1011623776', '1023941172', '1010844882', '1022115857', '1022116724', '1017520772', '1011130304', '1016610511', '1011173264', '1023961255', '1011577451', '1011133725', '1011069970', '1022318845')
    )
  ) AS OPScans
LEFT OUTER JOIN AnfPo AnfPoOut ON AnfPoOut.ID = OPScans.AnfPoID AND OPScans.AnfPoID > 0
LEFT OUTER JOIN AnfKo AnfKoOut ON AnfKoOut.ID = AnfPoOut.AnfKoID
LEFT OUTER JOIN AnfPo AnfPoIn ON AnfPoIn.ID = OPScans.EingAnfPoID AND OPScans.EingAnfPoID > 0
LEFT OUTER JOIN AnfKo AnfKoIn ON AnfKoIn.ID = AnfPoIn.AnfKoID
WHERE OPScans.ZielNrID = ZielNr.ID
  AND OPScans.OPGrundID = WegGrund.ID
ORDER BY OPScans.Code, OPScans.Zeitpunkt DESC;