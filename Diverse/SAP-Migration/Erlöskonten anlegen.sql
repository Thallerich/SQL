USE Wozabal;

DECLARE @Erloeskonto TABLE (
  Konto nchar(6),
  Bezeichnung nvarchar(50),
  MwSt nchar(2)
);

INSERT INTO @Erloeskonto
VALUES ('400001', 'ERLÖSE WASCHLOHN INTERN', '20'), ('400005', 'ERLÖSE FUHRPARKKOSTEN INTERN', '20'), ('400100', 'ERLÖSE HOTELLERIE -GAST', '20'), ('400400', 'ERLÖSE JOB', '20'), ('400500', 'ERLÖSE REINIGUNSTÜCHER', '20'), ('400600', 'ERLÖSE  MED', '20'), ('401400', 'ERLÖSE MICRO', '20'), ('401600', 'ERLÖSE MATTEN', '20'), ('401700', 'ERLÖSE FEMCARE', '20'), ('401800', 'ERLÖSE DUFTSPENDER', '20'), ('401900', 'ERLÖSE BERUFSBEKLEIDUNGSSPENDER', '20'), ('402000', 'ERLÖSE STOFFHANDTUCHSERVICE', '20'), ('402100', 'ERLÖSE LOHNWÄSCHE', '20'), ('402500', 'ERLÖSE HANDELSWAREN', '20'), ('402600', 'ERLÖSE WERBEMATTEN', '20'), ('402900', 'ERLÖSE VERKAUF TEXTILIEN', '20'), ('403300', 'ERLÖSE PERSÖHNLICHES WÄSCHESERVICE', '20'), ('403600', 'ERLÖSE ZUSTELLGEBÜHR', '20'), ('403601', 'ERLÖSE ZUSTELLGEBÜHR MWST FREI', '20'), ('430000', 'ERLÖSE HANDELSWARE UNGARN', '20'), ('430001', 'ERLÖSE HANDELSWARE MIETTEX WIEN', '20'), ('430100', 'ERLÖSE HANDELSWARE SERBIEN', '20'), ('430110', 'ERLÖSE HANDELSWARE POLEN', '20'), ('430150', 'ERLÖSE HANDELSWARE PERITEKS', '20'), ('430200', 'ERLÖSE HANDELSWARE CHEMUNG', '20'), ('430250', 'ERLÖSE HANDELSWARE LOTOS', '20'), ('430260', 'ERLÖSE HANDELSWARE RUMÄNIEN', '20'), ('430300', 'ERLÖSE HANDELSWARE BRATISLAVA', '20'), ('430400', 'ERLÖSE JOB STEUERFREI', '0'), ('430500', 'ERLÖSE MED STEUERFREI', '0'), ('430510', 'ERLÖSE MW + LW SLOWENIEN', '20'), ('430520', 'ERLÖSE MW + LW TSCHECHIEN', '20'), ('430530', 'ERLÖSE MW + LW KROATIEN', '20'), ('430540', 'ERLÖSE MW + LW RUMÄNIEN', '20'), ('430550', 'ERLÖSE MW + LW SLOWAKEI', '20'), ('430560', 'ERLÖSE MW + LW UNGARN', '20'), ('430570', 'ERLÖSE MW MIETTEX WIEN', '20'), ('430571', 'ERLÖSE LW MIETTEX WIEN', '20'), ('430572', 'ERLÖSE PWS MIETTEX WIEN', '20'), ('430600', 'ERLÖSE MW  STEUERFREI', '0'), ('430610', 'ERLÖSE LOHNWÄSCHE STEUERFREI', '0'), ('430800', 'ERLÖSE HANDELSWARE + HS STEUERFREI', '0'), ('442000', 'FORDERUNGSAUSFÄLLE', '20'), ('444000', 'SKONTOAUFWAND 20 %', '20'), ('444100', 'SKONTOAUFWAND 00 %', '20'), ('445000', 'MEHRZAHLUNGEN DEBITOREN', '20'), ('460100', 'ERLÖSE ANLAGENVERKAUF', '20'), ('461000', 'MEHRERLÖS ANLAGENABGANG', '20'), ('469998', 'ANLAGENABGANG', '20'), ('469999', 'VK ANLAGENZUGANG', '20'), ('480000', 'SONSTIGE BETRIEBLICHE ERLÖSE', '20'), ('480100', 'ERLÖSE DRITTSCHULDNER', '20'), ('480300', 'MIETERLÖSE 20 %', '20'), ('480440', 'VERSICHERUNGSVERGÜTUNG', '20');

INSERT INTO Wozabal.dbo.Konten (Konto, KsSt, Bez, MwStID, Artikel, Statistik1)
SELECT Erloeskonto.Konto, NULL AS KsSt, Erloeskonto.Bezeichnung, MwSt.ID AS MwStID, CAST(0 AS bit) AS Artikel, NULL AS Statistik1
FROM @Erloeskonto AS Erloeskonto
JOIN MwSt ON CAST(Erloeskonto.MwSt AS int) = MwSt.MWStSatz AND MwSt.SteuerSchl IN (N'03', N'07');